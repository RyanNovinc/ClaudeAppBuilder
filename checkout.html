<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - AppFoundry</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Checkout specific styles */
        .checkout-container {
            max-width: 900px;
            margin: 60px auto;
            padding: 0 20px;
        }
        
        .checkout-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .checkout-header h1 {
            font-size: 32px;
            margin-bottom: 15px;
        }
        
        .checkout-header p {
            color: var(--text-medium);
            font-size: 18px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .checkout-grid {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 40px;
        }
        
        .order-summary {
            background-color: var(--background-light);
            padding: 30px;
            border-radius: var(--border-radius);
            position: sticky;
            top: 100px;
        }
        
        .order-summary h2 {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: left;
        }
        
        .course-item {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-light);
        }
        
        .course-icon {
            width: 60px;
            height: 60px;
            background-color: rgba(0, 112, 243, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 24px;
        }
        
        .course-details {
            flex: 1;
        }
        
        .course-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .course-access {
            font-size: 14px;
            color: var(--text-light);
        }
        
        .course-price {
            font-weight: 600;
            font-size: 18px;
            color: var(--primary-color);
        }
        
        .order-total {
            display: flex;
            justify-content: space-between;
            padding-top: 20px;
            font-weight: 600;
            font-size: 20px;
        }
        
        .payment-form {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
        }
        
        .payment-form h2 {
            font-size: 24px;
            margin-bottom: 30px;
            text-align: left;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
        }
        
        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 112, 243, 0.2);
        }
        
        #card-element {
            padding: 14px;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            background-color: white;
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
        }
        
        #card-element:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 112, 243, 0.2);
        }
        
        #card-errors {
            color: var(--error-color);
            font-size: 14px;
            margin-top: 8px;
            min-height: 20px;
        }
        
        .checkout-button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 16px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: background-color var(--transition-fast);
            margin-top: 10px;
            min-height: 54px;
        }
        
        .checkout-button:hover {
            background-color: #ea580c;
        }
        
        .checkout-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .secure-note {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 20px;
            font-size: 14px;
            color: var(--text-light);
        }
        
        .secure-note svg {
            margin-right: 8px;
        }
        
        #loading {
            display: none;
            text-align: center;
            margin-top: 10px;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 112, 243, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        .guarantee-box {
            background-color: #fff8e6;
            border: 1px solid #FFD700;
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
            display: flex;
            align-items: center;
        }
        
        .guarantee-box-icon {
            font-size: 28px;
            margin-right: 15px;
            color: #FFD700;
        }
        
        .guarantee-box-text {
            font-size: 14px;
            line-height: 1.5;
        }
        
        .guarantee-box-text strong {
            display: block;
            margin-bottom: 5px;
        }
        
        .trust-badges {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-light);
        }
        
        .trust-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: var(--text-medium);
        }
        
        .trust-badge-icon {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
        }
        
        .order-bump {
            margin-top: 30px;
            background-color: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 20px;
        }
        
        .order-bump-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .order-bump-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .order-bump-title {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .order-bump-price {
            margin-left: auto;
            font-weight: 600;
        }
        
        .order-bump-description {
            padding-left: 30px;
            font-size: 14px;
            color: var(--text-medium);
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .checkout-grid {
                grid-template-columns: 1fr;
            }
            
            .checkout-container {
                margin: 30px auto;
            }
            
            .order-summary {
                position: static;
                margin-bottom: 30px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo"><a href="index.html">AppFoundry</a></div>
            <nav>
                <ul>
                    <li><a href="index.html#problem">The Problem</a></li>
                    <li><a href="index.html#solution">Our Solution</a></li>
                    <li><a href="index.html#curriculum">Curriculum</a></li>
                    <li><a href="index.html#pricing">Pricing</a></li>
                    <li><a href="success-stories.html">Success Stories</a></li>
                    <li><a href="about-creator.html">About</a></li>
                </ul>
            </nav>
            <button class="cta-button small" id="loginButton">Log in</button>
        </div>
    </header>

    <div class="guarantee-banner">
        <div class="container">
            <span class="guarantee-icon">ðŸ”’</span>
            <span class="guarantee-text"><strong>The "Build Your First App" Guarantee:</strong> Create an app in 60 days or get 100% of your money back</span>
            <a href="refund-policy.html" class="guarantee-link">Learn More</a>
        </div>
    </div>

    <div class="checkout-container">
        <div class="checkout-header">
            <h1>Complete Your Purchase</h1>
            <p>You're just one step away from building amazing apps without coding</p>
        </div>
        
        <div class="checkout-grid">
            <div class="payment-form">
                <h2>Payment Details</h2>
                <form id="payment-form">
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" required placeholder="Your email address">
                    </div>
                    
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <input type="text" id="name" name="name" required placeholder="Your full name">
                    </div>
                    
                    <div class="form-group">
                        <label for="card-element">Card Information</label>
                        <div id="card-element">
                            <!-- Stripe Card Element will be inserted here -->
                        </div>
                        <div id="card-errors" role="alert"></div>
                    </div>
                    
                    <div class="order-bump">
                        <div class="order-bump-header">
                            <input type="checkbox" id="order-bump-checkbox" class="order-bump-checkbox">
                            <label for="order-bump-checkbox" class="order-bump-title">Add AI Prompt Enhancement Tool</label>
                            <span class="order-bump-price">$47</span>
                        </div>
                        <div class="order-bump-description">
                            <p>Upgrade your app development with our AI Prompt Enhancement Tool. This tool automatically optimizes your prompts to get the best possible code from Claude AI, saving you hours of trial and error.</p>
                        </div>
                    </div>
                    
                    <button type="submit" id="submit-button" class="checkout-button">
                        Complete Purchase Securely
                    </button>
                    
                    <div id="loading">
                        <div class="loading-spinner"></div>
                        <span>Processing your payment...</span>
                    </div>
                    
                    <div class="secure-note">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>
                        All payments are securely encrypted with 256-bit SSL technology
                    </div>
                    
                    <div class="trust-badges">
                        <div class="trust-badge">
                            <div class="trust-badge-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                </svg>
                            </div>
                            <span>Secure Payment</span>
                        </div>
                        <div class="trust-badge">
                            <div class="trust-badge-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                    <path d="M9 12l2 2 4-4"></path>
                                </svg>
                            </div>
                            <span>60-Day Guarantee</span>
                        </div>
                        <div class="trust-badge">
                            <div class="trust-badge-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="12" y1="8" x2="12" y2="16"></line>
                                    <line x1="8" y1="12" x2="16" y2="12"></line>
                                </svg>
                            </div>
                            <span>Instant Access</span>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="order-summary">
                <h2>Order Summary</h2>
                <div id="course-item-container">
                    <!-- This will be populated by JavaScript based on URL parameters -->
                </div>
                <div class="order-total">
                    <span>Total</span>
                    <span id="order-total-price">$197</span>
                </div>
                
                <div class="guarantee-box">
                    <div class="guarantee-box-icon">ðŸ”’</div>
                    <div class="guarantee-box-text">
                        <strong>60-Day "Build Your First App" Guarantee</strong>
                        Create an app in 60 days or get 100% of your money back. No risk, all reward.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="logo">AppFoundry</div>
            <div class="footer-links">
                <div class="link-group">
                    <h4>Course</h4>
                    <ul>
                        <li><a href="index.html#problem">The Problem</a></li>
                        <li><a href="index.html#solution">Our Solution</a></li>
                        <li><a href="index.html#curriculum">Curriculum</a></li>
                        <li><a href="index.html#pricing">Pricing</a></li>
                        <li><a href="success-stories.html">Success Stories</a></li>
                        <li><a href="about-creator.html">About Creator</a></li>
                    </ul>
                </div>
                <div class="link-group">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="terms-of-service.html">Terms of Service</a></li>
                        <li><a href="privacy-policy.html">Privacy Policy</a></li>
                        <li><a href="refund-policy.html">Our Guarantee</a></li>
                    </ul>
                </div>
                <div class="link-group">
                    <h4>Contact</h4>
                    <ul>
                        <li><a href="mailto:hello@risegg.net">Email Support</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                Â© 2025 AppFoundry. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Load Stripe.js -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Parse URL parameters to determine which plan was selected
            const urlParams = new URLSearchParams(window.location.search);
            const selectedPlan = urlParams.get('plan') || 'essential';
            
            // Set up the course item display
            const courseItemContainer = document.getElementById('course-item-container');
            let planName, planPrice, planDescription;
            
            switch(selectedPlan) {
                case 'premium':
                    planName = 'AppFoundry Premium';
                    planPrice = '$497';
                    planDescription = 'Lifetime Access + All Premium Features';
                    break;
                case 'complete':
                    planName = 'AppFoundry Complete';
                    planPrice = '$297';
                    planDescription = 'Lifetime Access + Templates + Priority Support';
                    break;
                case 'complete-installment':
                    planName = 'AppFoundry Complete (Installment)';
                    planPrice = '$79 Ã— 3';
                    planDescription = 'Lifetime Access + Templates + Priority Support';
                    break;
                default:
                    planName = 'AppFoundry Essential';
                    planPrice = '$197';
                    planDescription = 'Lifetime Access';
            }
            
            courseItemContainer.innerHTML = `
                <div class="course-item">
                    <div class="course-icon">ðŸ“±</div>
                    <div class="course-details">
                        <div class="course-name">${planName}</div>
                        <div class="course-access">${planDescription}</div>
                    </div>
                    <div class="course-price">${planPrice}</div>
                </div>
            `;
            
            // Update order total
            document.getElementById('order-total-price').textContent = planPrice;
            
            // Set up the order bump
            const orderBumpCheckbox = document.getElementById('order-bump-checkbox');
            orderBumpCheckbox.addEventListener('change', function() {
                updateTotal();
            });
            
            function updateTotal() {
                let basePrice;
                switch(selectedPlan) {
                    case 'premium':
                        basePrice = 497;
                        break;
                    case 'complete':
                        basePrice = 297;
                        break;
                    case 'complete-installment':
                        basePrice = 79; // This is the first payment only
                        break;
                    default:
                        basePrice = 197;
                }
                
                // Add order bump price if checked
                let total = basePrice;
                if (orderBumpCheckbox.checked) {
                    total += 47;
                    
                    // Add order bump to items if not already present
                    if (!document.getElementById('order-bump-item')) {
                        const bumpItem = document.createElement('div');
                        bumpItem.id = 'order-bump-item';
                        bumpItem.className = 'course-item';
                        bumpItem.innerHTML = `
                            <div class="course-icon">ðŸ”§</div>
                            <div class="course-details">
                                <div class="course-name">AI Prompt Enhancement Tool</div>
                                <div class="course-access">Lifetime Access</div>
                            </div>
                            <div class="course-price">$47</div>
                        `;
                        courseItemContainer.appendChild(bumpItem);
                    }
                } else {
                    // Remove order bump item if it exists
                    const bumpItem = document.getElementById('order-bump-item');
                    if (bumpItem) {
                        bumpItem.remove();
                    }
                }
                
                // Update the total display
                document.getElementById('order-total-price').textContent = `${total}`;
            }
            
            // Initialize Stripe
            const stripe = Stripe('YOUR_PUBLISHABLE_KEY'); // Replace with your Stripe publishable key
            const elements = stripe.elements();
            const card = elements.create('card', {
                style: {
                    base: {
                        fontSize: '16px',
                        color: '#32325d',
                        fontFamily: '"Inter", sans-serif',
                        '::placeholder': {
                            color: '#aab7c4',
                        },
                    },
                    invalid: {
                        color: '#fa755a',
                        iconColor: '#fa755a',
                    },
                },
            });
            
            // Mount the card element
            card.mount('#card-element');
            
            // Handle validation errors
            card.addEventListener('change', function(event) {
                const displayError = document.getElementById('card-errors');
                if (event.error) {
                    displayError.textContent = event.error.message;
                } else {
                    displayError.textContent = '';
                }
            });
            
            // Handle form submission
            const form = document.getElementById('payment-form');
            form.addEventListener('submit', function(event) {
                event.preventDefault();
                
                // Disable the submit button to prevent multiple clicks
                document.getElementById('submit-button').disabled = true;
                document.getElementById('loading').style.display = 'block';
                
                // Collect customer data
                const customerData = {
                    name: document.getElementById('name').value,
                    email: document.getElementById('email').value,
                    plan: selectedPlan,
                    orderBump: orderBumpCheckbox.checked
                };
                
                // Create a payment intent on the server
                fetch('/create-payment-intent', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(customerData),
                })
                .then(function(response) {
                    return response.json();
                })
                .then(function(data) {
                    if (data.error) {
                        showError(data.error.message);
                        return;
                    }
                    
                    // Use the client secret to complete the payment
                    stripe.confirmCardPayment(data.clientSecret, {
                        payment_method: {
                            card: card,
                            billing_details: {
                                name: customerData.name,
                                email: customerData.email
                            },
                        },
                    })
                    .then(function(result) {
                        if (result.error) {
                            // Show error to customer
                            showError(result.error.message);
                        } else {
                            // Payment succeeded, redirect to thank you page
                            window.location.href = 'thank-you.html?session_id=' + data.sessionId + 
                                '&email=' + encodeURIComponent(customerData.email);
                        }
                    });
                })
                .catch(function(error) {
                    console.error('Error:', error);
                    showError("An error occurred while processing your payment. Please try again.");
                });
            });
            
            function showError(errorMessage) {
                const errorElement = document.getElementById('card-errors');
                errorElement.textContent = errorMessage;
                document.getElementById('submit-button').disabled = false;
                document.getElementById('loading').style.display = 'none';
            }
        });
    </script>
</body>
</html>
